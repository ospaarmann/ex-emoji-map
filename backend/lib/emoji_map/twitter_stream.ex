defmodule EmojiMap.TwitterStream do
  @moduledoc """
  We get a Twitter Stream from locations within a bounding box. The
  bounding box is so large that the tweets can come from all over the world.
  This way we make sure that we only receive geo-tagged tweets. The reason for
  this is: It isn't possible to search for hundreds of different keywords at
  once. Plus location isn't a filter. So we find tweets from either the location
  OR matching the keyword. We have to filter ourself.
  """

  @doc """
  The main function of this module. Gets the stream, filters for empty
  coordinates, filters for emojis and then returns a simpler map.
  """
  def get_emoji_stream do
    # Sometimes the coordinates are still empty. Probably when a place was selected.
    # Could be refined
    ExTwitter.stream_filter([locations: "-168.8,-57.3,174.4,84.1"], :infinity)
    |> Stream.filter(fn(x) -> x.coordinates != nil || x.place != nil end)
    |> Stream.filter(&Regex.match?(emoji_pattern(), &1.text))
    |> Stream.map(fn(x) ->
      coordinates = cond do
        x.coordinates != nil ->
          x.coordinates |> Map.fetch!(:coordinates)
          |> coord_arr_to_str
        x.place != nil ->
          x.place |> get_coordinates_from_place
          |> coord_arr_to_str
        true -> nil
      end

      emoji = x.text |> reduce_to_emoji
      |> first_emoji

      %{emoji: emoji, text: x.text, screen_name: x.user.screen_name,
      profile_image_url: x.user.profile_image_url, coordinates: coordinates}
    end)
  end

  @doc """
  Not used for this example. Just get a Stream for a keyword.
  """
  def get_stream(track) do
    [track: track] |> ExTwitter.stream_filter(:infinity)
    |> Stream.map(fn(x) ->
      %{text: x.text}
    end)
  end

  def reduce_to_emoji(input_string) do
    tmp_string = Regex.replace(no_emoji_pattern(), input_string, "")
    Regex.replace(~r/[\s]+/, tmp_string, "")
  end

  @doc """
  Finds emojis. This is ugly, I know. But the thing is that emojis are
  encoded all over the place in UTF-8. There is not one range of UTF-8 characters
  for emojis. So I put them right in here. It works, so shut up or provide me
  with a better regex.
  """
  def emoji_pattern do
    ~r/[ğŸ˜€ğŸ˜ƒğŸ˜„ğŸ˜ğŸ˜†ğŸ˜…ğŸ˜‚ğŸ¤£â˜ºï¸ğŸ˜ŠğŸ˜‡ğŸ™‚ğŸ™ƒğŸ˜‰ğŸ˜ŒğŸ˜ğŸ˜˜ğŸ˜—ğŸ˜™ğŸ˜šğŸ˜‹ğŸ˜œğŸ˜ğŸ˜›ğŸ¤‘ğŸ¤—ğŸ¤“ğŸ˜ğŸ¤¡ğŸ¤ ğŸ˜ğŸ˜’ğŸ˜ğŸ˜”ğŸ˜ŸğŸ˜•ğŸ™â˜¹ï¸ğŸ˜£ğŸ˜–ğŸ˜«ğŸ˜©ğŸ˜¤ğŸ˜ ğŸ˜¡ğŸ˜¶ğŸ˜ğŸ˜‘ğŸ˜¯ğŸ˜¦ğŸ˜§ğŸ˜®ğŸ˜²ğŸ˜µğŸ˜³ğŸ˜±ğŸ˜¨ğŸ˜°ğŸ˜¢ğŸ˜¥ğŸ¤¤ğŸ˜­ğŸ˜“ğŸ˜ªğŸ˜´ğŸ™„ğŸ¤”ğŸ¤¥ğŸ˜¬ğŸ¤ğŸ¤¢ğŸ¤§ğŸ˜·ğŸ¤’ğŸ¤•ğŸ˜ˆğŸ‘¿ğŸ‘¹ğŸ‘ºğŸ’©ğŸ‘»ğŸ’€â˜ ï¸ğŸ‘½ğŸ‘¾ğŸ¤–ğŸƒğŸ˜ºğŸ˜¸ğŸ˜¹ğŸ˜»ğŸ˜¼ğŸ˜½ğŸ™€ğŸ˜¿ğŸ˜¾ğŸ‘ğŸ™ŒğŸ‘ğŸ™ğŸ¤ğŸ‘ğŸ‘ğŸ‘ŠâœŠğŸ¤›ğŸ¤œğŸ¤âœŒï¸ğŸ¤˜ğŸ‘ŒğŸ‘ˆğŸ‘‰ğŸ‘†ğŸ‘‡â˜ï¸âœ‹ğŸ¤šğŸ–ğŸ––ğŸ‘‹ğŸ¤™ğŸ’ªğŸ–•âœï¸ğŸ¤³ğŸ’…ğŸ––ğŸ’„ğŸ’‹ğŸ‘„ğŸ‘…ğŸ‘‚ğŸ‘ƒğŸ‘£ğŸ‘ğŸ‘€ğŸ—£ğŸ‘¤ğŸ‘¥ğŸ‘¶ğŸ‘¦ğŸ‘§ğŸ‘¨ğŸ‘©ğŸ‘±â€â™€ï¸ğŸ‘±ğŸ‘´ğŸ‘µğŸ‘²ğŸ‘³â€â™€ï¸ğŸ‘³ğŸ‘®â€â™€ï¸ğŸ‘®ğŸ‘·â€â™€ï¸ğŸ‘·ğŸ’‚â€â™€ï¸ğŸ’‚ğŸ•µï¸â€â™€ï¸ğŸ•µï¸ğŸ‘©â€âš•ï¸ğŸ‘¨â€âš•ï¸ğŸ‘©â€ğŸŒ¾ğŸ‘¨â€ğŸŒ¾ğŸ‘©â€ğŸ³ğŸ‘¨â€ğŸ³ğŸ‘©â€ğŸ“ğŸ‘¨â€ğŸ“ğŸ‘©â€ğŸ¤ğŸ‘¨â€ğŸ¤ğŸ‘©â€ğŸ«ğŸ‘¨â€ğŸ«ğŸ‘©â€ğŸ­ğŸ‘¨â€ğŸ­ğŸ‘©â€ğŸ’»ğŸ‘¨â€ğŸ’»ğŸ‘©â€ğŸ’¼ğŸ‘¨â€ğŸ’¼ğŸ‘©â€ğŸ”§ğŸ‘¨â€ğŸ”§ğŸ‘©â€ğŸ”¬ğŸ‘¨â€ğŸ”¬ğŸ‘©â€ğŸ¨ğŸ‘¨â€ğŸ¨ğŸ‘©â€ğŸš’ğŸ‘¨â€ğŸš’ğŸ‘©â€âœˆï¸ğŸ‘¨â€âœˆï¸ğŸ‘©â€ğŸš€ğŸ‘¨â€ğŸš€ğŸ‘©â€âš–ï¸ğŸ‘¨â€âš–ï¸ğŸ¤¶ğŸ…ğŸ‘¸ğŸ¤´ğŸ‘°ğŸ¤µğŸ‘¼ğŸ¤°ğŸ™‡â€â™€ï¸ğŸ™‡ğŸ’ğŸ’â€â™‚ï¸ğŸ™…ğŸ™…â€â™‚ï¸ğŸ™†ğŸ™†â€â™‚ï¸ğŸ™‹ğŸ™‹â€â™‚ï¸ğŸ¤¦â€â™€ï¸ğŸ¤¦â€â™‚ï¸ğŸ¤·â€â™€ï¸ğŸ¤·â€â™‚ï¸ğŸ™ğŸ™â€â™‚ï¸ğŸ™ğŸ™â€â™‚ï¸ğŸ’‡ğŸ’‡â€â™‚ï¸ğŸ’†ğŸ’†â€â™‚ï¸ğŸ•´ğŸ’ƒğŸ•ºğŸ‘¯ğŸ‘¯â€â™‚ï¸ğŸš¶â€â™€ï¸ğŸš¶ğŸƒâ€â™€ï¸ğŸƒğŸ‘«ğŸ‘­ğŸ‘¬ğŸ’‘ğŸ‘©â€â¤ï¸â€ğŸ‘©ğŸ‘¨â€â¤ï¸â€ğŸ‘¨ğŸ’ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘©ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨ğŸ‘ªğŸ‘¨â€ğŸ‘©â€ğŸ‘§ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§ğŸ‘©â€ğŸ‘©â€ğŸ‘¦ğŸ‘©â€ğŸ‘©â€ğŸ‘§ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ‘©â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘§ğŸ‘©â€ğŸ‘¦ğŸ‘©â€ğŸ‘§ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ğŸ‘©â€ğŸ‘§â€ğŸ‘§ğŸ‘¨â€ğŸ‘¦ğŸ‘¨â€ğŸ‘§ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦ğŸ‘¨â€ğŸ‘§â€ğŸ‘§ğŸ‘šğŸ‘•ğŸ‘–ğŸ‘”ğŸ‘—ğŸ‘™ğŸ‘˜ğŸ‘ ğŸ‘¡ğŸ‘¢ğŸ‘ğŸ‘ŸğŸ‘’ğŸ©ğŸ“ğŸ‘‘â›‘ğŸ’ğŸ‘ğŸ‘›ğŸ‘œğŸ’¼ğŸ‘“ğŸ•¶ğŸŒ‚â˜‚ï¸ğŸ¶ğŸ±ğŸ­ğŸ¹ğŸ°ğŸ¦ŠğŸ»ğŸ¼ğŸ¨ğŸ¯ğŸ¦ğŸ®ğŸ·ğŸ½ğŸ¸ğŸµğŸ™ŠğŸ™‰ğŸ™ŠğŸ’ğŸ”ğŸ§ğŸ¦ğŸ¤ğŸ£ğŸ¥ğŸ¦†ğŸ¦…ğŸ¦‰ğŸ¦‡ğŸºğŸ—ğŸ´ğŸ¦„ğŸğŸ›ğŸ¦‹ğŸŒğŸšğŸğŸœğŸ•·ğŸ•¸ğŸ¢ğŸğŸ¦ğŸ¦‚ğŸ¦€ğŸ¦‘ğŸ™ğŸ¦ğŸ ğŸŸğŸ¡ğŸ¬ğŸ¦ˆğŸ³ğŸ‹ğŸŠğŸ†ğŸ…ğŸƒğŸ‚ğŸ„ğŸ¦ŒğŸªğŸ«ğŸ˜ğŸ¦ğŸ¦ğŸğŸ–ğŸğŸğŸ‘ğŸ•ğŸ©ğŸˆğŸ“ğŸ¦ƒğŸ•ŠğŸ‡ğŸğŸ€ğŸ¿ğŸ¾ğŸ‰ğŸ²ğŸŒµğŸ„ğŸŒ²ğŸŒ³ğŸŒ´ğŸŒ±ğŸŒ¿â˜˜ï¸ğŸ€ğŸğŸ‹ğŸƒğŸ‚ğŸğŸ„ğŸŒ¾ğŸ’ğŸŒ·ğŸŒ¹ğŸ¥€ğŸŒ»ğŸŒ¼ğŸŒ¸ğŸŒºğŸŒğŸŒğŸŒğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒšğŸŒğŸŒğŸŒ›ğŸŒœğŸŒ™ğŸ’«â­ï¸ğŸŒŸâœ¨âš¡ï¸ğŸ”¥ğŸ’¥â˜„ï¸â˜€ï¸ğŸŒ¤â›…ï¸ğŸŒ¥ğŸŒ¦ğŸŒˆâ˜ï¸ğŸŒ§â›ˆğŸŒ©ğŸŒ¨â˜ƒï¸â›„ï¸â„ï¸ğŸŒ¬ğŸ’¨ğŸŒªğŸŒ«ğŸŒŠğŸ’§ğŸ’¦â˜”ï¸ğŸğŸğŸğŸŠğŸ‹ğŸŒğŸ‰ğŸ‡ğŸ“ğŸˆğŸ’ğŸ‘ğŸğŸ¥ğŸ¥‘ğŸ…ğŸ†ğŸ¥’ğŸ¥•ğŸŒ½ğŸŒ¶ğŸ¥”ğŸ ğŸŒ°ğŸ¥œğŸ¯ğŸ¥ğŸğŸ¥–ğŸ§€ğŸ¥šğŸ³ğŸ¥“ğŸ¥ğŸ¤ğŸ—ğŸ–ğŸ•ğŸŒ­ğŸ”ğŸŸğŸ¥™ğŸŒ®ğŸŒ¯ğŸ¥—ğŸ¥˜ğŸğŸœğŸ²ğŸ¥ğŸ£ğŸ±ğŸ›ğŸšğŸ™ğŸ˜ğŸ¢ğŸ¡ğŸ§ğŸ¨ğŸ¦ğŸ°ğŸ‚ğŸ®ğŸ­ğŸ¬ğŸ«ğŸ¿ğŸ©ğŸªğŸ¥›ğŸ¼â˜•ï¸ğŸµğŸ¶ğŸºğŸ»ğŸ¥‚ğŸ·ğŸ¥ƒğŸ¸ğŸ¹ğŸ¾ğŸ¥„ğŸ´ğŸ½âš½ï¸ğŸ€ğŸˆâš¾ï¸ğŸ¾ğŸğŸ‰ğŸ±ğŸ“ğŸ¸ğŸ¥…ğŸ’ğŸ‘ğŸâ›³ï¸ğŸ¹ğŸ£ğŸ¥ŠğŸ¥‹â›¸ğŸ¿â›·ğŸ‚ğŸ‹ï¸â€â™€ï¸ğŸ‹ï¸ğŸ¤ºğŸ¤¼â€â™€ï¸ğŸ¤¼â€â™‚ï¸ğŸ¤¸â€â™€ï¸ğŸ¤¸â€â™‚ï¸â›¹ï¸â€â™€ï¸â›¹ï¸ğŸ¤¾â€â™€ï¸ğŸ¤¾â€â™‚ï¸ğŸŒï¸â€â™€ï¸ğŸŒï¸ğŸ„â€â™€ï¸ğŸ„ğŸŠâ€â™€ï¸ğŸŠğŸ¤½â€â™€ï¸ğŸ¤½â€â™‚ï¸ğŸš£â€â™€ï¸ğŸš£ğŸ‡ğŸš´â€â™€ï¸ğŸš´ğŸšµâ€â™€ï¸ğŸšµğŸ½ğŸ…ğŸ–ğŸ¥‡ğŸ¥ˆğŸ¥‰ğŸ†ğŸµğŸ—ğŸ«ğŸŸğŸªğŸ¤¹â€â™€ï¸ğŸ¤¹â€â™‚ï¸ğŸ­ğŸ¨ğŸ¬ğŸ¤ğŸ§ğŸ¼ğŸ¹ğŸ¥ğŸ·ğŸºğŸ¸ğŸ»ğŸ²ğŸ¯ğŸ³ğŸ®ğŸ°ğŸš—ğŸš•ğŸš™ğŸšŒğŸšğŸğŸš“ğŸš‘ğŸš’ğŸšğŸššğŸš›ğŸšœğŸ›´ğŸš²ğŸ›µğŸğŸš¨ğŸš”ğŸšğŸš˜ğŸš–ğŸš¡ğŸš ğŸšŸğŸšƒğŸš‹ğŸšğŸšğŸš„ğŸš…ğŸšˆğŸš‚ğŸš†ğŸš‡ğŸšŠğŸš‰ğŸšğŸ›©âœˆï¸ğŸ›«ğŸ›¬ğŸš€ğŸ›°ğŸ’ºğŸ›¶â›µï¸ğŸ›¥ğŸš¤ğŸ›³â›´ğŸš¢âš“ï¸ğŸš§â›½ï¸ğŸšğŸš¦ğŸš¥ğŸ—ºğŸ—¿ğŸ—½â›²ï¸ğŸ—¼ğŸ°ğŸ¯ğŸŸğŸ¡ğŸ¢ğŸ â›±ğŸ–ğŸâ›°ğŸ”ğŸ—»ğŸŒ‹ğŸœğŸ•â›ºï¸ğŸ›¤ğŸ›£ğŸ—ğŸ­ğŸ ğŸ¡ğŸ˜ğŸšğŸ¢ğŸ¬ğŸ£ğŸ¤ğŸ¥ğŸ¦ğŸ¨ğŸªğŸ«ğŸ©ğŸ’’ğŸ›â›ªï¸ğŸ•ŒğŸ•ğŸ•‹â›©ğŸ—¾ğŸ‘ğŸğŸŒ…ğŸŒ„ğŸŒ ğŸ‡ğŸ†ğŸŒ‡ğŸŒ†ğŸ™ğŸŒƒğŸŒŒğŸŒ‰ğŸŒğŸ†“ğŸ“—ğŸ“•âŒšï¸ğŸ“±ğŸ“²ğŸ’»âŒ¨ï¸ğŸ–¥ğŸ–¨ğŸ–±ğŸ–²ğŸ•¹ğŸ—œğŸ’½ğŸ’¾ğŸ’¿ğŸ“€ğŸ“¼ğŸ“·ğŸ“¸ğŸ“¹ğŸ¥ğŸ“½ğŸğŸ“â˜ï¸ğŸ“ŸğŸ“ ğŸ“ºğŸ“»ğŸ™ğŸšğŸ›â±â²â°ğŸ•°âŒ›ï¸â³ğŸ“¡ğŸ”‹ğŸ”ŒğŸ’¡ğŸ”¦ğŸ•¯ğŸ—‘ğŸ›¢ğŸ’¸ğŸ’µğŸ’´ğŸ’¶ğŸ’·ğŸ’°ğŸ’³ğŸ’âš–ï¸ğŸ”§ğŸ”¨âš’ğŸ› â›ğŸ”©âš™ï¸â›“ğŸ”«ğŸ’£ğŸ”ªğŸ—¡âš”ï¸ğŸ›¡ğŸš¬âš°ï¸âš±ï¸ğŸºğŸ”®ğŸ“¿ğŸ’ˆâš—ï¸ğŸ”­ğŸ”¬ğŸ•³ğŸ’ŠğŸ’‰ğŸŒ¡ğŸš½ğŸš°ğŸš¿ğŸ›ğŸ›€ğŸ›ğŸ”‘ğŸ—ğŸšªğŸ›‹ğŸ›ğŸ›ŒğŸ–¼ğŸ›ğŸ›’ğŸğŸˆğŸğŸ€ğŸŠğŸ‰ğŸğŸ®ğŸâœ‰ï¸ğŸ“©ğŸ“¨ğŸ“§ğŸ’ŒğŸ“¥ğŸ“¤ğŸ“¦ğŸ·ğŸ“ªğŸ“«ğŸ“¬ğŸ“­ğŸ“®ğŸ“¯ğŸ“œğŸ“ƒğŸ“„ğŸ“‘ğŸ“ŠğŸ“ˆğŸ“‰ğŸ—’ğŸ—“ğŸ“†ğŸ“…ğŸ“‡ğŸ—ƒğŸ—³ğŸ—„ğŸ“‹ğŸ“ğŸ“‚ğŸ—‚ğŸ—ğŸ“°ğŸ““ğŸ“”ğŸ“’ğŸ“•ğŸ“—ğŸ“˜ğŸ“™ğŸ“šğŸ“–ğŸ”–ğŸ”—ğŸ“ğŸ–‡ğŸ“ğŸ“ğŸ“ŒğŸ“ğŸ“ŒğŸŒğŸ³ï¸ğŸ´ğŸğŸ³ï¸â€ğŸŒˆâœ‚ï¸ğŸ–ŠğŸ–‹âœ’ï¸ğŸ–ŒğŸ–ğŸ“âœï¸ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”’ğŸ”“â¤ï¸ğŸ’›ğŸ’šğŸ’™ğŸ’œğŸ–¤ğŸ’”â£ï¸ğŸ’•ğŸ’ğŸ’“ğŸ’—ğŸ’–ğŸ’˜ğŸ’]/iu
  end

  @doc """
  Yes, I am lazy. Copy & paste plus inversion. Could be done better and is
  definitely not DRY.
  """
  def no_emoji_pattern do
    ~r/[^ğŸ˜€ğŸ˜ƒğŸ˜„ğŸ˜ğŸ˜†ğŸ˜…ğŸ˜‚ğŸ¤£â˜ºï¸ğŸ˜ŠğŸ˜‡ğŸ™‚ğŸ™ƒğŸ˜‰ğŸ˜ŒğŸ˜ğŸ˜˜ğŸ˜—ğŸ˜™ğŸ˜šğŸ˜‹ğŸ˜œğŸ˜ğŸ˜›ğŸ¤‘ğŸ¤—ğŸ¤“ğŸ˜ğŸ¤¡ğŸ¤ ğŸ˜ğŸ˜’ğŸ˜ğŸ˜”ğŸ˜ŸğŸ˜•ğŸ™â˜¹ï¸ğŸ˜£ğŸ˜–ğŸ˜«ğŸ˜©ğŸ˜¤ğŸ˜ ğŸ˜¡ğŸ˜¶ğŸ˜ğŸ˜‘ğŸ˜¯ğŸ˜¦ğŸ˜§ğŸ˜®ğŸ˜²ğŸ˜µğŸ˜³ğŸ˜±ğŸ˜¨ğŸ˜°ğŸ˜¢ğŸ˜¥ğŸ¤¤ğŸ˜­ğŸ˜“ğŸ˜ªğŸ˜´ğŸ™„ğŸ¤”ğŸ¤¥ğŸ˜¬ğŸ¤ğŸ¤¢ğŸ¤§ğŸ˜·ğŸ¤’ğŸ¤•ğŸ˜ˆğŸ‘¿ğŸ‘¹ğŸ‘ºğŸ’©ğŸ‘»ğŸ’€â˜ ï¸ğŸ‘½ğŸ‘¾ğŸ¤–ğŸƒğŸ˜ºğŸ˜¸ğŸ˜¹ğŸ˜»ğŸ˜¼ğŸ˜½ğŸ™€ğŸ˜¿ğŸ˜¾ğŸ‘ğŸ™ŒğŸ‘ğŸ™ğŸ¤ğŸ‘ğŸ‘ğŸ‘ŠâœŠğŸ¤›ğŸ¤œğŸ¤âœŒï¸ğŸ¤˜ğŸ‘ŒğŸ‘ˆğŸ‘‰ğŸ‘†ğŸ‘‡â˜ï¸âœ‹ğŸ¤šğŸ–ğŸ––ğŸ‘‹ğŸ¤™ğŸ’ªğŸ–•âœï¸ğŸ¤³ğŸ’…ğŸ––ğŸ’„ğŸ’‹ğŸ‘„ğŸ‘…ğŸ‘‚ğŸ‘ƒğŸ‘£ğŸ‘ğŸ‘€ğŸ—£ğŸ‘¤ğŸ‘¥ğŸ‘¶ğŸ‘¦ğŸ‘§ğŸ‘¨ğŸ‘©ğŸ‘±â€â™€ï¸ğŸ‘±ğŸ‘´ğŸ‘µğŸ‘²ğŸ‘³â€â™€ï¸ğŸ‘³ğŸ‘®â€â™€ï¸ğŸ‘®ğŸ‘·â€â™€ï¸ğŸ‘·ğŸ’‚â€â™€ï¸ğŸ’‚ğŸ•µï¸â€â™€ï¸ğŸ•µï¸ğŸ‘©â€âš•ï¸ğŸ‘¨â€âš•ï¸ğŸ‘©â€ğŸŒ¾ğŸ‘¨â€ğŸŒ¾ğŸ‘©â€ğŸ³ğŸ‘¨â€ğŸ³ğŸ‘©â€ğŸ“ğŸ‘¨â€ğŸ“ğŸ‘©â€ğŸ¤ğŸ‘¨â€ğŸ¤ğŸ‘©â€ğŸ«ğŸ‘¨â€ğŸ«ğŸ‘©â€ğŸ­ğŸ‘¨â€ğŸ­ğŸ‘©â€ğŸ’»ğŸ‘¨â€ğŸ’»ğŸ‘©â€ğŸ’¼ğŸ‘¨â€ğŸ’¼ğŸ‘©â€ğŸ”§ğŸ‘¨â€ğŸ”§ğŸ‘©â€ğŸ”¬ğŸ‘¨â€ğŸ”¬ğŸ‘©â€ğŸ¨ğŸ‘¨â€ğŸ¨ğŸ‘©â€ğŸš’ğŸ‘¨â€ğŸš’ğŸ‘©â€âœˆï¸ğŸ‘¨â€âœˆï¸ğŸ‘©â€ğŸš€ğŸ‘¨â€ğŸš€ğŸ‘©â€âš–ï¸ğŸ‘¨â€âš–ï¸ğŸ¤¶ğŸ…ğŸ‘¸ğŸ¤´ğŸ‘°ğŸ¤µğŸ‘¼ğŸ¤°ğŸ™‡â€â™€ï¸ğŸ™‡ğŸ’ğŸ’â€â™‚ï¸ğŸ™…ğŸ™…â€â™‚ï¸ğŸ™†ğŸ™†â€â™‚ï¸ğŸ™‹ğŸ™‹â€â™‚ï¸ğŸ¤¦â€â™€ï¸ğŸ¤¦â€â™‚ï¸ğŸ¤·â€â™€ï¸ğŸ¤·â€â™‚ï¸ğŸ™ğŸ™â€â™‚ï¸ğŸ™ğŸ™â€â™‚ï¸ğŸ’‡ğŸ’‡â€â™‚ï¸ğŸ’†ğŸ’†â€â™‚ï¸ğŸ•´ğŸ’ƒğŸ•ºğŸ‘¯ğŸ‘¯â€â™‚ï¸ğŸš¶â€â™€ï¸ğŸš¶ğŸƒâ€â™€ï¸ğŸƒğŸ‘«ğŸ‘­ğŸ‘¬ğŸ’‘ğŸ‘©â€â¤ï¸â€ğŸ‘©ğŸ‘¨â€â¤ï¸â€ğŸ‘¨ğŸ’ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘©ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨ğŸ‘ªğŸ‘¨â€ğŸ‘©â€ğŸ‘§ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§ğŸ‘©â€ğŸ‘©â€ğŸ‘¦ğŸ‘©â€ğŸ‘©â€ğŸ‘§ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ‘©â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘§ğŸ‘©â€ğŸ‘¦ğŸ‘©â€ğŸ‘§ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ğŸ‘©â€ğŸ‘§â€ğŸ‘§ğŸ‘¨â€ğŸ‘¦ğŸ‘¨â€ğŸ‘§ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦ğŸ‘¨â€ğŸ‘§â€ğŸ‘§ğŸ‘šğŸ‘•ğŸ‘–ğŸ‘”ğŸ‘—ğŸ‘™ğŸ‘˜ğŸ‘ ğŸ‘¡ğŸ‘¢ğŸ‘ğŸ‘ŸğŸ‘’ğŸ©ğŸ“ğŸ‘‘â›‘ğŸ’ğŸ‘ğŸ‘›ğŸ‘œğŸ’¼ğŸ‘“ğŸ•¶ğŸŒ‚â˜‚ï¸ğŸ¶ğŸ±ğŸ­ğŸ¹ğŸ°ğŸ¦ŠğŸ»ğŸ¼ğŸ¨ğŸ¯ğŸ¦ğŸ®ğŸ·ğŸ½ğŸ¸ğŸµğŸ™ŠğŸ™‰ğŸ™ŠğŸ’ğŸ”ğŸ§ğŸ¦ğŸ¤ğŸ£ğŸ¥ğŸ¦†ğŸ¦…ğŸ¦‰ğŸ¦‡ğŸºğŸ—ğŸ´ğŸ¦„ğŸğŸ›ğŸ¦‹ğŸŒğŸšğŸğŸœğŸ•·ğŸ•¸ğŸ¢ğŸğŸ¦ğŸ¦‚ğŸ¦€ğŸ¦‘ğŸ™ğŸ¦ğŸ ğŸŸğŸ¡ğŸ¬ğŸ¦ˆğŸ³ğŸ‹ğŸŠğŸ†ğŸ…ğŸƒğŸ‚ğŸ„ğŸ¦ŒğŸªğŸ«ğŸ˜ğŸ¦ğŸ¦ğŸğŸ–ğŸğŸğŸ‘ğŸ•ğŸ©ğŸˆğŸ“ğŸ¦ƒğŸ•ŠğŸ‡ğŸğŸ€ğŸ¿ğŸ¾ğŸ‰ğŸ²ğŸŒµğŸ„ğŸŒ²ğŸŒ³ğŸŒ´ğŸŒ±ğŸŒ¿â˜˜ï¸ğŸ€ğŸğŸ‹ğŸƒğŸ‚ğŸğŸ„ğŸŒ¾ğŸ’ğŸŒ·ğŸŒ¹ğŸ¥€ğŸŒ»ğŸŒ¼ğŸŒ¸ğŸŒºğŸŒğŸŒğŸŒğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒšğŸŒğŸŒğŸŒ›ğŸŒœğŸŒ™ğŸ’«â­ï¸ğŸŒŸâœ¨âš¡ï¸ğŸ”¥ğŸ’¥â˜„ï¸â˜€ï¸ğŸŒ¤â›…ï¸ğŸŒ¥ğŸŒ¦ğŸŒˆâ˜ï¸ğŸŒ§â›ˆğŸŒ©ğŸŒ¨â˜ƒï¸â›„ï¸â„ï¸ğŸŒ¬ğŸ’¨ğŸŒªğŸŒ«ğŸŒŠğŸ’§ğŸ’¦â˜”ï¸ğŸğŸğŸğŸŠğŸ‹ğŸŒğŸ‰ğŸ‡ğŸ“ğŸˆğŸ’ğŸ‘ğŸğŸ¥ğŸ¥‘ğŸ…ğŸ†ğŸ¥’ğŸ¥•ğŸŒ½ğŸŒ¶ğŸ¥”ğŸ ğŸŒ°ğŸ¥œğŸ¯ğŸ¥ğŸğŸ¥–ğŸ§€ğŸ¥šğŸ³ğŸ¥“ğŸ¥ğŸ¤ğŸ—ğŸ–ğŸ•ğŸŒ­ğŸ”ğŸŸğŸ¥™ğŸŒ®ğŸŒ¯ğŸ¥—ğŸ¥˜ğŸğŸœğŸ²ğŸ¥ğŸ£ğŸ±ğŸ›ğŸšğŸ™ğŸ˜ğŸ¢ğŸ¡ğŸ§ğŸ¨ğŸ¦ğŸ°ğŸ‚ğŸ®ğŸ­ğŸ¬ğŸ«ğŸ¿ğŸ©ğŸªğŸ¥›ğŸ¼â˜•ï¸ğŸµğŸ¶ğŸºğŸ»ğŸ¥‚ğŸ·ğŸ¥ƒğŸ¸ğŸ¹ğŸ¾ğŸ¥„ğŸ´ğŸ½âš½ï¸ğŸ€ğŸˆâš¾ï¸ğŸ¾ğŸğŸ‰ğŸ±ğŸ“ğŸ¸ğŸ¥…ğŸ’ğŸ‘ğŸâ›³ï¸ğŸ¹ğŸ£ğŸ¥ŠğŸ¥‹â›¸ğŸ¿â›·ğŸ‚ğŸ‹ï¸â€â™€ï¸ğŸ‹ï¸ğŸ¤ºğŸ¤¼â€â™€ï¸ğŸ¤¼â€â™‚ï¸ğŸ¤¸â€â™€ï¸ğŸ¤¸â€â™‚ï¸â›¹ï¸â€â™€ï¸â›¹ï¸ğŸ¤¾â€â™€ï¸ğŸ¤¾â€â™‚ï¸ğŸŒï¸â€â™€ï¸ğŸŒï¸ğŸ„â€â™€ï¸ğŸ„ğŸŠâ€â™€ï¸ğŸŠğŸ¤½â€â™€ï¸ğŸ¤½â€â™‚ï¸ğŸš£â€â™€ï¸ğŸš£ğŸ‡ğŸš´â€â™€ï¸ğŸš´ğŸšµâ€â™€ï¸ğŸšµğŸ½ğŸ…ğŸ–ğŸ¥‡ğŸ¥ˆğŸ¥‰ğŸ†ğŸµğŸ—ğŸ«ğŸŸğŸªğŸ¤¹â€â™€ï¸ğŸ¤¹â€â™‚ï¸ğŸ­ğŸ¨ğŸ¬ğŸ¤ğŸ§ğŸ¼ğŸ¹ğŸ¥ğŸ·ğŸºğŸ¸ğŸ»ğŸ²ğŸ¯ğŸ³ğŸ®ğŸ°ğŸš—ğŸš•ğŸš™ğŸšŒğŸšğŸğŸš“ğŸš‘ğŸš’ğŸšğŸššğŸš›ğŸšœğŸ›´ğŸš²ğŸ›µğŸğŸš¨ğŸš”ğŸšğŸš˜ğŸš–ğŸš¡ğŸš ğŸšŸğŸšƒğŸš‹ğŸšğŸšğŸš„ğŸš…ğŸšˆğŸš‚ğŸš†ğŸš‡ğŸšŠğŸš‰ğŸšğŸ›©âœˆï¸ğŸ›«ğŸ›¬ğŸš€ğŸ›°ğŸ’ºğŸ›¶â›µï¸ğŸ›¥ğŸš¤ğŸ›³â›´ğŸš¢âš“ï¸ğŸš§â›½ï¸ğŸšğŸš¦ğŸš¥ğŸ—ºğŸ—¿ğŸ—½â›²ï¸ğŸ—¼ğŸ°ğŸ¯ğŸŸğŸ¡ğŸ¢ğŸ â›±ğŸ–ğŸâ›°ğŸ”ğŸ—»ğŸŒ‹ğŸœğŸ•â›ºï¸ğŸ›¤ğŸ›£ğŸ—ğŸ­ğŸ ğŸ¡ğŸ˜ğŸšğŸ¢ğŸ¬ğŸ£ğŸ¤ğŸ¥ğŸ¦ğŸ¨ğŸªğŸ«ğŸ©ğŸ’’ğŸ›â›ªï¸ğŸ•ŒğŸ•ğŸ•‹â›©ğŸ—¾ğŸ‘ğŸğŸŒ…ğŸŒ„ğŸŒ ğŸ‡ğŸ†ğŸŒ‡ğŸŒ†ğŸ™ğŸŒƒğŸŒŒğŸŒ‰ğŸŒğŸ†“ğŸ“—ğŸ“•âŒšï¸ğŸ“±ğŸ“²ğŸ’»âŒ¨ï¸ğŸ–¥ğŸ–¨ğŸ–±ğŸ–²ğŸ•¹ğŸ—œğŸ’½ğŸ’¾ğŸ’¿ğŸ“€ğŸ“¼ğŸ“·ğŸ“¸ğŸ“¹ğŸ¥ğŸ“½ğŸğŸ“â˜ï¸ğŸ“ŸğŸ“ ğŸ“ºğŸ“»ğŸ™ğŸšğŸ›â±â²â°ğŸ•°âŒ›ï¸â³ğŸ“¡ğŸ”‹ğŸ”ŒğŸ’¡ğŸ”¦ğŸ•¯ğŸ—‘ğŸ›¢ğŸ’¸ğŸ’µğŸ’´ğŸ’¶ğŸ’·ğŸ’°ğŸ’³ğŸ’âš–ï¸ğŸ”§ğŸ”¨âš’ğŸ› â›ğŸ”©âš™ï¸â›“ğŸ”«ğŸ’£ğŸ”ªğŸ—¡âš”ï¸ğŸ›¡ğŸš¬âš°ï¸âš±ï¸ğŸºğŸ”®ğŸ“¿ğŸ’ˆâš—ï¸ğŸ”­ğŸ”¬ğŸ•³ğŸ’ŠğŸ’‰ğŸŒ¡ğŸš½ğŸš°ğŸš¿ğŸ›ğŸ›€ğŸ›ğŸ”‘ğŸ—ğŸšªğŸ›‹ğŸ›ğŸ›ŒğŸ–¼ğŸ›ğŸ›’ğŸğŸˆğŸğŸ€ğŸŠğŸ‰ğŸğŸ®ğŸâœ‰ï¸ğŸ“©ğŸ“¨ğŸ“§ğŸ’ŒğŸ“¥ğŸ“¤ğŸ“¦ğŸ·ğŸ“ªğŸ“«ğŸ“¬ğŸ“­ğŸ“®ğŸ“¯ğŸ“œğŸ“ƒğŸ“„ğŸ“‘ğŸ“ŠğŸ“ˆğŸ“‰ğŸ—’ğŸ—“ğŸ“†ğŸ“…ğŸ“‡ğŸ—ƒğŸ—³ğŸ—„ğŸ“‹ğŸ“ğŸ“‚ğŸ—‚ğŸ—ğŸ“°ğŸ““ğŸ“”ğŸ“’ğŸ“•ğŸ“—ğŸ“˜ğŸ“™ğŸ“šğŸ“–ğŸ”–ğŸ”—ğŸ“ğŸ–‡ğŸ“ğŸ“ğŸ“ŒğŸ“ğŸ“ŒğŸŒğŸ³ï¸ğŸ´ğŸğŸ³ï¸â€ğŸŒˆâœ‚ï¸ğŸ–ŠğŸ–‹âœ’ï¸ğŸ–ŒğŸ–ğŸ“âœï¸ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”’ğŸ”“â¤ï¸ğŸ’›ğŸ’šğŸ’™ğŸ’œğŸ–¤ğŸ’”â£ï¸ğŸ’•ğŸ’ğŸ’“ğŸ’—ğŸ’–ğŸ’˜ğŸ’]/iu
  end

  def first_emoji(input_string) do
    input_string |> String.codepoints |> hd
  end

  @doc """
  Turn array with float numbers from Twitter API into String
  """
  def coord_arr_to_str(input_arr) do
    input_arr
    |> Enum.map(fn(x) -> "#{x}" end)
    |> Enum.join(",")
  end

  @doc """
  Places from the Twitter API are not a single point but a bouding box. For easy
  use we will just use the first coordinates. To find out more check here:
  https://dev.twitter.com/overview/api/tweets
  """
  def get_coordinates_from_place(%{bounding_box: %{coordinates: [bounding_box]}}) do
    bounding_box |> hd
  end

end
